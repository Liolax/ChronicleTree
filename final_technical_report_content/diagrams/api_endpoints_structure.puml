@startuml API Endpoints Structure
!theme aws-orange
title ChronicleTree API Endpoints Structure (Actual Implementation)

left to right direction

package "Authentication (Devise-JWT)" {
  [POST /api/v1/auth] as Register
  [POST /api/v1/auth/sign_in] as SignIn
  [DELETE /api/v1/auth/sign_out] as SignOut
  [POST /api/v1/auth/password] as ResetPassword
  [PUT /api/v1/auth/password] as UpdatePassword
}

package "People Management" {
  [GET /api/v1/people] as GetPeople
  [POST /api/v1/people] as CreatePerson
  [GET /api/v1/people/:id] as GetPerson
  [PUT /api/v1/people/:id] as UpdatePerson
  [DELETE /api/v1/people/:id] as DeletePerson
  [GET /api/v1/people/:person_id/media] as GetPersonMedia
  [POST /api/v1/people/:person_id/media] as CreatePersonMedia
  [GET /api/v1/people/:person_id/timeline_facts] as GetPersonTimeline
  [POST /api/v1/people/:person_id/timeline_facts] as CreatePersonTimeline
  [GET /api/v1/people/:person_id/relationships] as GetPersonRelationships
  [POST /api/v1/people/:person_id/relationships] as CreatePersonRelationship
}

package "Relationship Management" {
  [POST /api/v1/relationships] as CreateRelationship
  [DELETE /api/v1/relationships/:id] as DeleteRelationship
  [PUT /api/v1/relationships/:id/toggle_deceased] as ToggleDeceased
}

package "Media Management" {
  [GET /api/v1/media/:id] as GetMedia
  [PUT /api/v1/media/:id] as UpdateMedia
  [DELETE /api/v1/media/:id] as DeleteMedia
  [GET /api/v1/profiles/:id] as GetProfile
  [PUT /api/v1/profiles/:id] as UpdateProfile
}

package "Timeline & Facts" {
  [GET /api/v1/timeline_facts] as GetTimelineFacts
  [POST /api/v1/timeline_facts] as CreateTimelineFact
  [GET /api/v1/timeline_facts/:id] as GetTimelineFact
  [PUT /api/v1/timeline_facts/:id] as UpdateTimelineFact
  [DELETE /api/v1/timeline_facts/:id] as DeleteTimelineFact
}

package "Social Sharing" {
  [GET /api/v1/people_shares] as GetShares
  [POST /api/v1/people_shares] as CreateShare
  [DELETE /api/v1/people_shares/:id] as DeleteShare
}

package "System Health" {
  [GET /api/v1/health] as HealthCheck
  [GET /api/v1/monitoring] as Monitoring
}

' Authentication flow
Register --> SignIn : Account Created
SignIn --> SignOut : JWT Session

' People management flow
GetPeople --> CreatePerson : Add Family Member
CreatePerson --> GetPerson : View Details
GetPerson --> UpdatePerson : Edit Information
GetPerson --> GetPersonMedia : View Media
GetPerson --> GetPersonTimeline : View Timeline
GetPerson --> GetPersonRelationships : View Relationships

' Relationship flow
GetPersonRelationships --> CreatePersonRelationship : Add Relationship
CreatePersonRelationship --> ToggleDeceased : Update Status

' Media flow
GetPersonMedia --> CreatePersonMedia : Add Media
CreatePersonMedia --> GetMedia : View Media Details
GetMedia --> UpdateMedia : Edit Media Info

' Timeline flow
GetPersonTimeline --> CreatePersonTimeline : Add Life Event
CreatePersonTimeline --> GetTimelineFacts : View All Facts
GetTimelineFacts --> UpdateTimelineFact : Edit Events

' Sharing flow
GetPeople --> CreateShare : Share Person
CreateShare --> GetShares : View Shared Items

note right of Register : "Devise Registration\nJWT Authentication\nEmail & Password Validation"
note right of CreatePersonRelationship : "Nested under People\nTemporal Validation\nBidirectional Updates"
note right of CreatePersonMedia : "File Upload Support\nNested Resource\nLinked to People"
note bottom of HealthCheck : "System Status\nDatabase Connectivity\nService Health"

@enduml

@enduml
