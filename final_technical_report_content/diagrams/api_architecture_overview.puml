@startuml ChronicleTree API Architecture - ACTUAL IMPLEMENTATION
!theme aws-orange
left to right direction

title ChronicleTree API Architecture Overview\nBased on Actual Rails Routes and Controllers

package "Authentication Layer" as auth {
  [JWT Authentication] as jwt
  [Devise Sessions] as sessions
  [User Registration] as registration
  [Password Management] as password
}

package "Core API Endpoints" as core {
  [People Management] as people
  [Relationship Building] as relationships
  [User Accounts] as users
  [Profile Management] as profiles
}

package "Content Management" as content {
  [Timeline Items] as timeline
  [Custom Facts] as facts
  [Media Uploads] as media
  [Personal Notes] as notes
}

package "Social Features" as social {
  [Share Generation] as shares
  [Share Images] as share_images
  [Public Sharing] as public_shares
}

package "System Health" as system {
  [Health Check] as health
  [Ping Endpoint] as ping
}

' Authentication flows (Devise routes)
jwt --> sessions : "POST /api/v1/auth/sign_in"
sessions --> registration : "POST /api/v1/auth"
password --> sessions : "POST /api/v1/auth/password"

' Core data flows (Authenticated endpoints)
auth --> core : "protects all API endpoints"
people --> relationships : "create/destroy relationships"
users --> people : "owns family data"

' Content flows (Nested under people)
people --> timeline : "timeline_items nested routes"
people --> facts : "facts nested routes"
people --> media : "media nested routes"
people --> notes : "notes nested routes"
people --> profiles : "profile management"

' Social flows
core --> social : "sharing features"
shares --> share_images : "generates OG images"
public_shares --> share_images : "serves public content"

' System flows
system --> core : "health monitoring"

note top of auth : "Devise + JWT\nToken-based authentication\nAPI-only mode"
note bottom of social : "Social media sharing\nGenerated share images\nPublic profile links"
note right of content : "Nested under people\nRESTful resource design\nPolymorphic associations"

@enduml

@enduml
