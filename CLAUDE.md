🎯 SINGLE ROOT MODE: Starting with Robert Doe (ID: 9) at generation 0
familyTreeHierarchicalLayout.js:619 Queue initialized with: [9]
familyTreeHierarchicalLayout.js:647 Robert Doe (ID: 9) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child John Doe at generation 1 (from Robert)
familyTreeHierarchicalLayout.js:647 Molly Doe (ID: 8) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child John Doe at generation 1 (from Molly)
familyTreeHierarchicalLayout.js:647 John Doe (ID: 1) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Alice Doe at generation 2 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Charlie Doe at generation 2 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 2 (from John)
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 1 - already visited
familyTreeHierarchicalLayout.js:647 Lisa Doe (ID: 12) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 2 (from Lisa)
familyTreeHierarchicalLayout.js:647 Alice Doe (ID: 3) -> Generation 2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Bob Anderson at generation 3 (from Alice)
familyTreeHierarchicalLayout.js:674   Adding child Emily Anderson at generation 3 (from Alice)
familyTreeHierarchicalLayout.js:647 Charlie Doe (ID: 7) -> Generation 2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Emma Doe at generation 3 (from Charlie)
familyTreeHierarchicalLayout.js:647 Michael Doe (ID: 13) -> Generation 2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 13 - already visited
familyTreeHierarchicalLayout.js:647 Bob Anderson (ID: 5) -> Generation 3
familyTreeHierarchicalLayout.js:647 Emily Anderson (ID: 6) -> Generation 3
2familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 7 - already visited
familyTreeHierarchicalLayout.js:647 Emma Doe (ID: 14) -> Generation 3 ⚠️ DOE FAMILY
2familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 6 - already visited
familyTreeHierarchicalLayout.js:618 🎯 SINGLE ROOT MODE: Starting with Robert Doe (ID: 9) at generation 0
familyTreeHierarchicalLayout.js:619 Queue initialized with: [9]
familyTreeHierarchicalLayout.js:647 Robert Doe (ID: 9) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child John Doe at generation 1 (from Robert)
familyTreeHierarchicalLayout.js:647 Molly Doe (ID: 8) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child John Doe at generation 1 (from Molly)
familyTreeHierarchicalLayout.js:647 John Doe (ID: 1) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Alice Doe at generation 2 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Charlie Doe at generation 2 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 2 (from John)
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 1 - already visited
familyTreeHierarchicalLayout.js:647 Lisa Doe (ID: 12) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 2 (from Lisa)
familyTreeHierarchicalLayout.js:647 Alice Doe (ID: 3) -> Generation 2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Bob Anderson at generation 3 (from Alice)
familyTreeHierarchicalLayout.js:674   Adding child Emily Anderson at generation 3 (from Alice)
familyTreeHierarchicalLayout.js:647 Charlie Doe (ID: 7) -> Generation 2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Emma Doe at generation 3 (from Charlie)
familyTreeHierarchicalLayout.js:647 Michael Doe (ID: 13) -> Generation 2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 13 - already visited
familyTreeHierarchicalLayout.js:647 Bob Anderson (ID: 5) -> Generation 3
familyTreeHierarchicalLayout.js:647 Emily Anderson (ID: 6) -> Generation 3
2familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 7 - already visited
familyTreeHierarchicalLayout.js:647 Emma Doe (ID: 14) -> Generation 3 ⚠️ DOE FAMILY
2familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 6 - already visited
improvedRelationshipCalculator.js?t=1753907426013:20 🚀 STARTING calculateRelationshipToRoot: Lisa(12) -> Emily(6)
improvedRelationshipCalculator.js?t=1753907426013:21 Input validation - person: true rootPerson: true allPeople: true relationships: true
improvedRelationshipCalculator.js?t=1753907426013:42 🕐 TIMELINE CHECK 1: Person born after root died?
improvedRelationshipCalculator.js?t=1753907426013:43 Emily birth: Tue Jan 01 2019 00:00:00 GMT+0000 (Greenwich Mean Time) Lisa death: null
improvedRelationshipCalculator.js?t=1753907426013:44 Check result: null
improvedRelationshipCalculator.js?t=1753907426013:119 🕐 TIMELINE CHECK 2: Root born after person died?
improvedRelationshipCalculator.js?t=1753907426013:120 Lisa birth: Fri Jun 10 1994 01:00:00 GMT+0100 (British Summer Time) Emily death: null
improvedRelationshipCalculator.js?t=1753907426013:121 Check result: null
improvedRelationshipCalculator.js?t=1753907426013:199 ✅ REACHED MAIN ALGORITHM - passed timeline checks
improvedRelationshipCalculator.js?t=1753907426013:207 🔍 CALLING findRelationship(Emily=6, Lisa=12)
improvedRelationshipCalculator.js?t=1753907426013:462 🎯 ENTERED findRelationship: Emily(6) -> Lisa(12)
improvedRelationshipCalculator.js?t=1753907426013:479 🔍 No direct relationship, checking step-relationships...
improvedRelationshipCalculator.js?t=1753907426013:492 🔍 No blood relationship, checking step-relationships...
improvedRelationshipCalculator.js?t=1753907426013:727 🎯 ENTERED findStepRelationship: Emily(6) -> Lisa(12)
improvedRelationshipCalculator.js?t=1753907426013:759 🕐 STEP-RELATIONSHIP TIMELINE VALIDATION starting...
improvedRelationshipCalculator.js?t=1753907426013:760 deceasedSpouseMap entries: 6
improvedRelationshipCalculator.js?t=1753907426013:783 ❌ TIMELINE VALIDATION BLOCKED: Person born after deceased spouse died
improvedRelationshipCalculator.js?t=1753907426013:784 Deceased spouse ID: 11
improvedRelationshipCalculator.js?t=1753907426013:785 Deceased person name: Thomas Anderson
improvedRelationshipCalculator.js?t=1753907426013:786 Deceased person death date: 2018-05-14
improvedRelationshipCalculator.js?t=1753907426013:787 Emily birth date: 2019-01-01
improvedRelationshipCalculator.js?t=1753907426013:788 This deceased spouse is incorrectly blocking the Lisa->Emily step-relationship
improvedRelationshipCalculator.js?t=1753907426013:505 ❌ No step relationship found from findStepRelationship
improvedRelationshipCalculator.js?t=1753907426013:522 ❌ RETURNING UNRELATED for Lisa->Emily - no relationship found
improvedRelationshipCalculator.js?t=1753907426013:523 All relationship checks completed, no match found
improvedRelationshipCalculator.js?t=1753907426013:220 🔍 findRelationship returned: Unrelated
FamilyTreeFlow.jsx:103 🎯 DEEP DEBUG - WHY UNRELATED?
FamilyTreeFlow.jsx:106 Expected relationship path:
FamilyTreeFlow.jsx:107 Lisa (12) -> John (1) -> Alice (3) -> Emily (6)
FamilyTreeFlow.jsx:114 Lisa -> John relationship: {person_id: 12, relative_id: 1, relationship_type: 'spouse', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:115 John -> Alice relationship: {person_id: 1, relative_id: 3, relationship_type: 'child', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:116 Alice -> Emily relationship: {person_id: 3, relative_id: 6, relationship_type: 'child', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:123 John -> Lisa relationship: {person_id: 1, relative_id: 12, relationship_type: 'spouse', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:124 Alice -> John relationship: {person_id: 3, relative_id: 1, relationship_type: 'parent', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:125 Emily -> Alice relationship: {person_id: 6, relative_id: 3, relationship_type: 'parent', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:130 Alice -> David relationship: {person_id: 3, relative_id: 4, relationship_type: 'spouse', is_ex: true, is_deceased: false}
FamilyTreeFlow.jsx:131 David -> Alice relationship: {person_id: 4, relative_id: 3, relationship_type: 'spouse', is_ex: true, is_deceased: false}
FamilyTreeFlow.jsx:134 ID type check:
FamilyTreeFlow.jsx:135 Lisa ID: 12 number
FamilyTreeFlow.jsx:136 Emily ID: 6 number
FamilyTreeFlow.jsx:137 Sample relationship person_id: 1 number
improvedRelationshipCalculator.js?t=1753907426013:20 🚀 STARTING calculateRelationshipToRoot: Lisa(12) -> Emily(6)
improvedRelationshipCalculator.js?t=1753907426013:21 Input validation - person: true rootPerson: true allPeople: true relationships: true
improvedRelationshipCalculator.js?t=1753907426013:42 🕐 TIMELINE CHECK 1: Person born after root died?
improvedRelationshipCalculator.js?t=1753907426013:43 Emily birth: Tue Jan 01 2019 00:00:00 GMT+0000 (Greenwich Mean Time) Lisa death: null
improvedRelationshipCalculator.js?t=1753907426013:44 Check result: null
improvedRelationshipCalculator.js?t=1753907426013:119 🕐 TIMELINE CHECK 2: Root born after person died?
improvedRelationshipCalculator.js?t=1753907426013:120 Lisa birth: Fri Jun 10 1994 01:00:00 GMT+0100 (British Summer Time) Emily death: null
improvedRelationshipCalculator.js?t=1753907426013:121 Check result: null
improvedRelationshipCalculator.js?t=1753907426013:199 ✅ REACHED MAIN ALGORITHM - passed timeline checks
improvedRelationshipCalculator.js?t=1753907426013:207 🔍 CALLING findRelationship(Emily=6, Lisa=12)
improvedRelationshipCalculator.js?t=1753907426013:462 🎯 ENTERED findRelationship: Emily(6) -> Lisa(12)
improvedRelationshipCalculator.js?t=1753907426013:479 🔍 No direct relationship, checking step-relationships...
improvedRelationshipCalculator.js?t=1753907426013:492 🔍 No blood relationship, checking step-relationships...
improvedRelationshipCalculator.js?t=1753907426013:727 🎯 ENTERED findStepRelationship: Emily(6) -> Lisa(12)
improvedRelationshipCalculator.js?t=1753907426013:759 🕐 STEP-RELATIONSHIP TIMELINE VALIDATION starting...
improvedRelationshipCalculator.js?t=1753907426013:760 deceasedSpouseMap entries: 6
improvedRelationshipCalculator.js?t=1753907426013:783 ❌ TIMELINE VALIDATION BLOCKED: Person born after deceased spouse died
improvedRelationshipCalculator.js?t=1753907426013:784 Deceased spouse ID: 11
improvedRelationshipCalculator.js?t=1753907426013:785 Deceased person name: Thomas Anderson
improvedRelationshipCalculator.js?t=1753907426013:786 Deceased person death date: 2018-05-14
improvedRelationshipCalculator.js?t=1753907426013:787 Emily birth date: 2019-01-01
improvedRelationshipCalculator.js?t=1753907426013:788 This deceased spouse is incorrectly blocking the Lisa->Emily step-relationship
improvedRelationshipCalculator.js?t=1753907426013:505 ❌ No step relationship found from findStepRelationship
improvedRelationshipCalculator.js?t=1753907426013:522 ❌ RETURNING UNRELATED for Lisa->Emily - no relationship found
improvedRelationshipCalculator.js?t=1753907426013:523 All relationship checks completed, no match found
improvedRelationshipCalculator.js?t=1753907426013:220 🔍 findRelationship returned: Unrelated
FamilyTreeFlow.jsx:103 🎯 DEEP DEBUG - WHY UNRELATED?
FamilyTreeFlow.jsx:106 Expected relationship path:
FamilyTreeFlow.jsx:107 Lisa (12) -> John (1) -> Alice (3) -> Emily (6)
FamilyTreeFlow.jsx:114 Lisa -> John relationship: {person_id: 12, relative_id: 1, relationship_type: 'spouse', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:115 John -> Alice relationship: {person_id: 1, relative_id: 3, relationship_type: 'child', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:116 Alice -> Emily relationship: {person_id: 3, relative_id: 6, relationship_type: 'child', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:123 John -> Lisa relationship: {person_id: 1, relative_id: 12, relationship_type: 'spouse', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:124 Alice -> John relationship: {person_id: 3, relative_id: 1, relationship_type: 'parent', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:125 Emily -> Alice relationship: {person_id: 6, relative_id: 3, relationship_type: 'parent', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:130 Alice -> David relationship: {person_id: 3, relative_id: 4, relationship_type: 'spouse', is_ex: true, is_deceased: false}
FamilyTreeFlow.jsx:131 David -> Alice relationship: {person_id: 4, relative_id: 3, relationship_type: 'spouse', is_ex: true, is_deceased: false}
FamilyTreeFlow.jsx:134 ID type check:
FamilyTreeFlow.jsx:135 Lisa ID: 12 number
FamilyTreeFlow.jsx:136 Emily ID: 6 number
FamilyTreeFlow.jsx:137 Sample relationship person_id: 1 number
familyTreeHierarchicalLayout.js:618 🎯 SINGLE ROOT MODE: Starting with Lisa Doe (ID: 12) at generation 0
familyTreeHierarchicalLayout.js:619 Queue initialized with: [12]
familyTreeHierarchicalLayout.js:647 Lisa Doe (ID: 12) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 1 (from Lisa)
familyTreeHierarchicalLayout.js:698   Adding parent William O'Sullivan at generation -1 (from Lisa)
familyTreeHierarchicalLayout.js:698   Adding parent Patricia Smith at generation -1 (from Lisa)
familyTreeHierarchicalLayout.js:647 John Doe (ID: 1) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Alice Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Charlie Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:698   Adding parent Molly Doe at generation -2 (from John) (spouse's parent)
familyTreeHierarchicalLayout.js:698   Adding parent Robert Doe at generation -2 (from John) (spouse's parent)
familyTreeHierarchicalLayout.js:647 Michael Doe (ID: 13) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 William O'Sullivan (ID: 15) -> Generation -1
familyTreeHierarchicalLayout.js:647 Patricia Smith (ID: 16) -> Generation -1
familyTreeHierarchicalLayout.js:647 Alice Doe (ID: 3) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Bob Anderson at generation 2 (from Alice)
familyTreeHierarchicalLayout.js:647 Charlie Doe (ID: 7) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Emma Doe at generation 2 (from Charlie)
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 13 - already visited
familyTreeHierarchicalLayout.js:647 Molly Doe (ID: 8) -> Generation -2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 Robert Doe (ID: 9) -> Generation -2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 Bob Anderson (ID: 5) -> Generation 2
2familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 7 - already visited
familyTreeHierarchicalLayout.js:647 Emma Doe (ID: 14) -> Generation 2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 9 - already visited
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 6 - already visited
familyTreeHierarchicalLayout.js:618 🎯 SINGLE ROOT MODE: Starting with Lisa Doe (ID: 12) at generation 0
familyTreeHierarchicalLayout.js:619 Queue initialized with: [12]
familyTreeHierarchicalLayout.js:647 Lisa Doe (ID: 12) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 1 (from Lisa)
familyTreeHierarchicalLayout.js:698   Adding parent William O'Sullivan at generation -1 (from Lisa)
familyTreeHierarchicalLayout.js:698   Adding parent Patricia Smith at generation -1 (from Lisa)
familyTreeHierarchicalLayout.js:647 John Doe (ID: 1) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Alice Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Charlie Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:698   Adding parent Molly Doe at generation -2 (from John) (spouse's parent)
familyTreeHierarchicalLayout.js:698   Adding parent Robert Doe at generation -2 (from John) (spouse's parent)
familyTreeHierarchicalLayout.js:647 Michael Doe (ID: 13) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 William O'Sullivan (ID: 15) -> Generation -1
familyTreeHierarchicalLayout.js:647 Patricia Smith (ID: 16) -> Generation -1
familyTreeHierarchicalLayout.js:647 Alice Doe (ID: 3) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Bob Anderson at generation 2 (from Alice)
familyTreeHierarchicalLayout.js:647 Charlie Doe (ID: 7) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Emma Doe at generation 2 (from Charlie)
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 13 - already visited
familyTreeHierarchicalLayout.js:647 Molly Doe (ID: 8) -> Generation -2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 Robert Doe (ID: 9) -> Generation -2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 Bob Anderson (ID: 5) -> Generation 2
2familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 7 - already visited
familyTreeHierarchicalLayout.js:647 Emma Doe (ID: 14) -> Generation 2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 9 - already visited
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 6 - already visited
improvedRelationshipCalculator.js:20 🚀 STARTING calculateRelationshipToRoot: Lisa(12) -> Emily(6)
improvedRelationshipCalculator.js:21 Input validation - person: true rootPerson: true allPeople: true relationships: true
improvedRelationshipCalculator.js:42 🕐 TIMELINE CHECK 1: Person born after root died?
improvedRelationshipCalculator.js:43 Emily birth: Tue Jan 01 2019 00:00:00 GMT+0000 (Greenwich Mean Time) Lisa death: null
improvedRelationshipCalculator.js:44 Check result: null
improvedRelationshipCalculator.js:119 🕐 TIMELINE CHECK 2: Root born after person died?
improvedRelationshipCalculator.js:120 Lisa birth: Fri Jun 10 1994 01:00:00 GMT+0100 (British Summer Time) Emily death: null
improvedRelationshipCalculator.js:121 Check result: null
improvedRelationshipCalculator.js:199 ✅ REACHED MAIN ALGORITHM - passed timeline checks
improvedRelationshipCalculator.js:207 🔍 CALLING findRelationship(Emily=6, Lisa=12)
improvedRelationshipCalculator.js:462 🎯 ENTERED findRelationship: Emily(6) -> Lisa(12)
improvedRelationshipCalculator.js:479 🔍 No direct relationship, checking step-relationships...
improvedRelationshipCalculator.js:492 🔍 No blood relationship, checking step-relationships...
improvedRelationshipCalculator.js:727 🎯 ENTERED findStepRelationship: Emily(6) -> Lisa(12)
improvedRelationshipCalculator.js:759 🕐 STEP-RELATIONSHIP TIMELINE VALIDATION starting...
improvedRelationshipCalculator.js:760 deceasedSpouseMap entries: 6
improvedRelationshipCalculator.js:783 ⚠️ TIMELINE CHECK: Deceased spouse might block connection
improvedRelationshipCalculator.js:784 Deceased spouse ID: 11
improvedRelationshipCalculator.js:785 Deceased person name: Thomas Anderson
improvedRelationshipCalculator.js:786 Expected path: Lisa -> John -> Alice -> Emily
improvedRelationshipCalculator.js:787 Thomas Anderson should NOT block this path - fixing logic...
improvedRelationshipCalculator.js:807 ✅ ALLOWED: Thomas Anderson is not in the Lisa->John->Alice->Emily path, continuing...
improvedRelationshipCalculator.js:853 ✅ TIMELINE VALIDATION PASSED - continuing to step-relationship checks
improvedRelationshipCalculator.js:858 🔍 Checking step-parent relationships...
improvedRelationshipCalculator.js:983 🔍 REACHED STEP-GRANDPARENT SECTION (Lisa->Emily)
improvedRelationshipCalculator.js:984 childToParents map has Emily(6)? true
improvedRelationshipCalculator.js:985 Emily parents from map: (2) ['3', '4']
improvedRelationshipCalculator.js:995 🔍 STEP-GRANDPARENT DEBUG (Lisa->Emily):
improvedRelationshipCalculator.js:996 personParentsForGrandparent (Emily parents): (2) ['3', '4']
improvedRelationshipCalculator.js:997 Expected: Emily should have Alice (3) and David (4) as parents
improvedRelationshipCalculator.js:1006 Emily parent 3 has grandparents: (2) ['1', '2']
improvedRelationshipCalculator.js:1015 Grandparent 1 spouses: ['12']
improvedRelationshipCalculator.js:1016 Is Lisa (12) married to grandparent 1? true
improvedRelationshipCalculator.js:499 🎯 STEP RELATIONSHIP FOUND: Step-Granddaughter
improvedRelationshipCalculator.js:220 🔍 findRelationship returned: Step-Granddaughter
FamilyTreeFlow.jsx:103 🎯 DEEP DEBUG - WHY UNRELATED?
FamilyTreeFlow.jsx:106 Expected relationship path:
FamilyTreeFlow.jsx:107 Lisa (12) -> John (1) -> Alice (3) -> Emily (6)
FamilyTreeFlow.jsx:114 Lisa -> John relationship: {person_id: 12, relative_id: 1, relationship_type: 'spouse', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:115 John -> Alice relationship: {person_id: 1, relative_id: 3, relationship_type: 'child', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:116 Alice -> Emily relationship: {person_id: 3, relative_id: 6, relationship_type: 'child', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:123 John -> Lisa relationship: {person_id: 1, relative_id: 12, relationship_type: 'spouse', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:124 Alice -> John relationship: {person_id: 3, relative_id: 1, relationship_type: 'parent', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:125 Emily -> Alice relationship: {person_id: 6, relative_id: 3, relationship_type: 'parent', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:130 Alice -> David relationship: {person_id: 3, relative_id: 4, relationship_type: 'spouse', is_ex: true, is_deceased: false}
FamilyTreeFlow.jsx:131 David -> Alice relationship: {person_id: 4, relative_id: 3, relationship_type: 'spouse', is_ex: true, is_deceased: false}
FamilyTreeFlow.jsx:134 ID type check:
FamilyTreeFlow.jsx:135 Lisa ID: 12 number
FamilyTreeFlow.jsx:136 Emily ID: 6 number
FamilyTreeFlow.jsx:137 Sample relationship person_id: 1 number
improvedRelationshipCalculator.js:20 🚀 STARTING calculateRelationshipToRoot: Lisa(12) -> Emily(6)
improvedRelationshipCalculator.js:21 Input validation - person: true rootPerson: true allPeople: true relationships: true
improvedRelationshipCalculator.js:42 🕐 TIMELINE CHECK 1: Person born after root died?
improvedRelationshipCalculator.js:43 Emily birth: Tue Jan 01 2019 00:00:00 GMT+0000 (Greenwich Mean Time) Lisa death: null
improvedRelationshipCalculator.js:44 Check result: null
improvedRelationshipCalculator.js:119 🕐 TIMELINE CHECK 2: Root born after person died?
improvedRelationshipCalculator.js:120 Lisa birth: Fri Jun 10 1994 01:00:00 GMT+0100 (British Summer Time) Emily death: null
improvedRelationshipCalculator.js:121 Check result: null
improvedRelationshipCalculator.js:199 ✅ REACHED MAIN ALGORITHM - passed timeline checks
improvedRelationshipCalculator.js:207 🔍 CALLING findRelationship(Emily=6, Lisa=12)
improvedRelationshipCalculator.js:462 🎯 ENTERED findRelationship: Emily(6) -> Lisa(12)
improvedRelationshipCalculator.js:479 🔍 No direct relationship, checking step-relationships...
improvedRelationshipCalculator.js:492 🔍 No blood relationship, checking step-relationships...
improvedRelationshipCalculator.js:727 🎯 ENTERED findStepRelationship: Emily(6) -> Lisa(12)
improvedRelationshipCalculator.js:759 🕐 STEP-RELATIONSHIP TIMELINE VALIDATION starting...
improvedRelationshipCalculator.js:760 deceasedSpouseMap entries: 6
improvedRelationshipCalculator.js:783 ⚠️ TIMELINE CHECK: Deceased spouse might block connection
improvedRelationshipCalculator.js:784 Deceased spouse ID: 11
improvedRelationshipCalculator.js:785 Deceased person name: Thomas Anderson
improvedRelationshipCalculator.js:786 Expected path: Lisa -> John -> Alice -> Emily
improvedRelationshipCalculator.js:787 Thomas Anderson should NOT block this path - fixing logic...
improvedRelationshipCalculator.js:807 ✅ ALLOWED: Thomas Anderson is not in the Lisa->John->Alice->Emily path, continuing...
improvedRelationshipCalculator.js:853 ✅ TIMELINE VALIDATION PASSED - continuing to step-relationship checks
improvedRelationshipCalculator.js:858 🔍 Checking step-parent relationships...
improvedRelationshipCalculator.js:983 🔍 REACHED STEP-GRANDPARENT SECTION (Lisa->Emily)
improvedRelationshipCalculator.js:984 childToParents map has Emily(6)? true
improvedRelationshipCalculator.js:985 Emily parents from map: (2) ['3', '4']
improvedRelationshipCalculator.js:995 🔍 STEP-GRANDPARENT DEBUG (Lisa->Emily):
improvedRelationshipCalculator.js:996 personParentsForGrandparent (Emily parents): (2) ['3', '4']
improvedRelationshipCalculator.js:997 Expected: Emily should have Alice (3) and David (4) as parents
improvedRelationshipCalculator.js:1006 Emily parent 3 has grandparents: (2) ['1', '2']
improvedRelationshipCalculator.js:1015 Grandparent 1 spouses: ['12']
improvedRelationshipCalculator.js:1016 Is Lisa (12) married to grandparent 1? true
improvedRelationshipCalculator.js:499 🎯 STEP RELATIONSHIP FOUND: Step-Granddaughter
improvedRelationshipCalculator.js:220 🔍 findRelationship returned: Step-Granddaughter
FamilyTreeFlow.jsx:103 🎯 DEEP DEBUG - WHY UNRELATED?
FamilyTreeFlow.jsx:106 Expected relationship path:
FamilyTreeFlow.jsx:107 Lisa (12) -> John (1) -> Alice (3) -> Emily (6)
FamilyTreeFlow.jsx:114 Lisa -> John relationship: {person_id: 12, relative_id: 1, relationship_type: 'spouse', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:115 John -> Alice relationship: {person_id: 1, relative_id: 3, relationship_type: 'child', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:116 Alice -> Emily relationship: {person_id: 3, relative_id: 6, relationship_type: 'child', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:123 John -> Lisa relationship: {person_id: 1, relative_id: 12, relationship_type: 'spouse', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:124 Alice -> John relationship: {person_id: 3, relative_id: 1, relationship_type: 'parent', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:125 Emily -> Alice relationship: {person_id: 6, relative_id: 3, relationship_type: 'parent', is_ex: false, is_deceased: false}
FamilyTreeFlow.jsx:130 Alice -> David relationship: {person_id: 3, relative_id: 4, relationship_type: 'spouse', is_ex: true, is_deceased: false}
FamilyTreeFlow.jsx:131 David -> Alice relationship: {person_id: 4, relative_id: 3, relationship_type: 'spouse', is_ex: true, is_deceased: false}
FamilyTreeFlow.jsx:134 ID type check:
FamilyTreeFlow.jsx:135 Lisa ID: 12 number
FamilyTreeFlow.jsx:136 Emily ID: 6 number
FamilyTreeFlow.jsx:137 Sample relationship person_id: 1 number
familyTreeHierarchicalLayout.js:618 🎯 SINGLE ROOT MODE: Starting with Lisa Doe (ID: 12) at generation 0
familyTreeHierarchicalLayout.js:619 Queue initialized with: [12]
familyTreeHierarchicalLayout.js:647 Lisa Doe (ID: 12) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 1 (from Lisa)
familyTreeHierarchicalLayout.js:698   Adding parent William O'Sullivan at generation -1 (from Lisa)
familyTreeHierarchicalLayout.js:698   Adding parent Patricia Smith at generation -1 (from Lisa)
familyTreeHierarchicalLayout.js:647 John Doe (ID: 1) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Alice Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Charlie Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:698   Adding parent Molly Doe at generation -2 (from John) (spouse's parent)
familyTreeHierarchicalLayout.js:698   Adding parent Robert Doe at generation -2 (from John) (spouse's parent)
familyTreeHierarchicalLayout.js:647 Michael Doe (ID: 13) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 William O'Sullivan (ID: 15) -> Generation -1
familyTreeHierarchicalLayout.js:647 Patricia Smith (ID: 16) -> Generation -1
familyTreeHierarchicalLayout.js:647 Alice Doe (ID: 3) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Bob Anderson at generation 2 (from Alice)
familyTreeHierarchicalLayout.js:674   Adding child Emily Anderson at generation 2 (from Alice)
familyTreeHierarchicalLayout.js:647 Charlie Doe (ID: 7) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Emma Doe at generation 2 (from Charlie)
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 13 - already visited
familyTreeHierarchicalLayout.js:647 Molly Doe (ID: 8) -> Generation -2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 Robert Doe (ID: 9) -> Generation -2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 Bob Anderson (ID: 5) -> Generation 2
familyTreeHierarchicalLayout.js:647 Emily Anderson (ID: 6) -> Generation 2
2familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 7 - already visited
familyTreeHierarchicalLayout.js:647 Emma Doe (ID: 14) -> Generation 2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 9 - already visited
2familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 6 - already visited
familyTreeHierarchicalLayout.js:618 🎯 SINGLE ROOT MODE: Starting with Lisa Doe (ID: 12) at generation 0
familyTreeHierarchicalLayout.js:619 Queue initialized with: [12]
familyTreeHierarchicalLayout.js:647 Lisa Doe (ID: 12) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 1 (from Lisa)
familyTreeHierarchicalLayout.js:698   Adding parent William O'Sullivan at generation -1 (from Lisa)
familyTreeHierarchicalLayout.js:698   Adding parent Patricia Smith at generation -1 (from Lisa)
familyTreeHierarchicalLayout.js:647 John Doe (ID: 1) -> Generation 0 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Alice Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Charlie Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:674   Adding child Michael Doe at generation 1 (from John)
familyTreeHierarchicalLayout.js:698   Adding parent Molly Doe at generation -2 (from John) (spouse's parent)
familyTreeHierarchicalLayout.js:698   Adding parent Robert Doe at generation -2 (from John) (spouse's parent)
familyTreeHierarchicalLayout.js:647 Michael Doe (ID: 13) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 William O'Sullivan (ID: 15) -> Generation -1
familyTreeHierarchicalLayout.js:647 Patricia Smith (ID: 16) -> Generation -1
familyTreeHierarchicalLayout.js:647 Alice Doe (ID: 3) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Bob Anderson at generation 2 (from Alice)
familyTreeHierarchicalLayout.js:674   Adding child Emily Anderson at generation 2 (from Alice)
familyTreeHierarchicalLayout.js:647 Charlie Doe (ID: 7) -> Generation 1 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:674   Adding child Emma Doe at generation 2 (from Charlie)
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 13 - already visited
familyTreeHierarchicalLayout.js:647 Molly Doe (ID: 8) -> Generation -2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 Robert Doe (ID: 9) -> Generation -2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:647 Bob Anderson (ID: 5) -> Generation 2
familyTreeHierarchicalLayout.js:647 Emily Anderson (ID: 6) -> Generation 2
2familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 7 - already visited
familyTreeHierarchicalLayout.js:647 Emma Doe (ID: 14) -> Generation 2 ⚠️ DOE FAMILY
familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 9 - already visited
2familyTreeHierarchicalLayout.js:626 ⚠️ SKIPPING 6 - already visited