<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced SweetAlert Test</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        /* Include our custom CSS inline for testing */
        /* SweetAlert2 custom styles for proper z-index and positioning */

        /* High z-index class for ensuring modals appear above all content */
        .swal-high-z-index {
          z-index: 2147483647 !important;
        }

        /* Ensure SweetAlert container has maximum z-index */
        .swal2-container {
          z-index: 2147483647 !important;
        }

        /* Ensure backdrop is below the modal but above everything else */
        .swal2-backdrop-show {
          z-index: 2147483646 !important;
        }

        /* Custom styles for consistent modal appearance */
        .swal-container-custom {
          z-index: 2147483647 !important;
        }

        .swal-popup-custom {
          font-family: 'Inter', sans-serif !important;
          background: #FEFEFA !important;
          border-radius: 1.5rem !important;
          box-shadow: 0 8px 32px rgba(0,0,0,0.18) !important;
          border: 2px solid #A0C49D !important;
          padding: 2rem !important;
          min-width: 320px !important;
          max-width: 400px !important;
          width: 100% !important;
          z-index: 2147483647 !important;
        }

        .swal-title-custom {
          color: #4F868E !important;
          font-weight: 600 !important;
          font-size: 1.25rem !important;
          margin-bottom: 1rem !important;
        }

        .swal-content-custom {
          color: #374151 !important;
          font-size: 0.95rem !important;
          line-height: 1.5 !important;
          margin-bottom: 1.5rem !important;
        }

        .swal-actions-custom {
          margin-top: 1.5rem !important;
          gap: 0.75rem !important;
        }

        .swal-ok-btn {
          background: #4F46E5 !important;
          color: white !important;
          border: none !important;
          border-radius: 0.75rem !important;
          padding: 0.75rem 1.5rem !important;
          font-weight: 600 !important;
          font-size: 0.95rem !important;
          cursor: pointer !important;
          transition: all 0.2s ease !important;
        }

        .swal-ok-btn:hover {
          background: #4338CA !important;
          transform: translateY(-1px) !important;
        }

        .swal-confirm-btn {
          background: #dc2626 !important;
          color: white !important;
          border: none !important;
          border-radius: 0.75rem !important;
          padding: 0.75rem 1.5rem !important;
          font-weight: 600 !important;
          font-size: 0.95rem !important;
          cursor: pointer !important;
          transition: all 0.2s ease !important;
        }

        .swal-confirm-btn:hover {
          background: #b91c1c !important;
          transform: translateY(-1px) !important;
        }

        .swal-cancel-btn {
          background: #6b7280 !important;
          color: white !important;
          border: none !important;
          border-radius: 0.75rem !important;
          padding: 0.75rem 1.5rem !important;
          font-weight: 600 !important;
          font-size: 0.95rem !important;
          cursor: pointer !important;
          transition: all 0.2s ease !important;
        }

        .swal-cancel-btn:hover {
          background: #4b5563 !important;
          transform: translateY(-1px) !important;
        }

        .swal-icon-custom {
          border: none !important;
          margin: 0 auto 1rem !important;
        }

        /* Modal management - hide other modals when SweetAlert is active */
        .modal[data-was-visible="true"],
        .dialog[data-was-visible="true"],
        [role="dialog"][data-was-visible="true"],
        .overlay[data-was-visible="true"],
        .popup[data-was-visible="true"] {
          display: none !important;
          visibility: hidden !important;
        }

        /* Ensure SweetAlert always appears above everything */
        .swal2-container {
          z-index: 2147483647 !important;
        }

        .swal2-backdrop {
          z-index: 2147483646 !important;
        }

        /* Test page styles */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 2rem;
            background: #f3f4f6;
        }

        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .test-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .test-btn {
            background: #4F46E5;
            color: white;
            border: none;
            border-radius: 0.75rem;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .test-btn:hover {
            background: #4338CA;
            transform: translateY(-1px);
        }

        .existing-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Enhanced SweetAlert Test</h1>
        <p>Test the enhanced SweetAlert functionality with consistent styling and modal management.</p>
        
        <div class="test-buttons">
            <button class="test-btn" onclick="testError()">Test Error Alert</button>
            <button class="test-btn" onclick="testSuccess()">Test Success Alert</button>
            <button class="test-btn" onclick="testWarning()">Test Warning Alert</button>
            <button class="test-btn" onclick="testInfo()">Test Info Alert</button>
            <button class="test-btn" onclick="testConfirm()">Test Confirm Dialog</button>
            <button class="test-btn" onclick="testDeleteConfirm()">Test Delete Confirm</button>
            <button class="test-btn" onclick="testToast()">Test Toast</button>
            <button class="test-btn" onclick="testModalManagement()">Test Modal Management</button>
            <button class="test-btn" onclick="testOperationSuccess()">Test Professional Success Messages</button>
        </div>

        <div class="test-results">
            <h3>Test Results:</h3>
            <div id="results"></div>
        </div>
    </div>

    <!-- Existing modal for testing modal management -->
    <div class="modal-overlay" id="modalOverlay"></div>
    <div class="existing-modal" id="existingModal">
        <h3>Existing Modal</h3>
        <p>This modal should be hidden when SweetAlert appears.</p>
        <button onclick="hideExistingModal()">Close</button>
    </div>

    <script>
        // Modal management functions (from our enhanced sweetAlerts.js)
        const hideAllOtherModals = () => {
          const modals = document.querySelectorAll('.modal, .dialog, [role="dialog"], .overlay, .popup, .existing-modal');
          const hiddenModals = [];
          
          modals.forEach(modal => {
            if (!modal.classList.contains('swal2-container') && !modal.closest('.swal2-container')) {
              if (modal.style.display !== 'none' && !modal.hidden) {
                modal.dataset.wasVisible = 'true';
                modal.style.display = 'none';
                hiddenModals.push(modal);
              }
            }
          });
          
          return hiddenModals;
        };

        const restoreHiddenModals = () => {
          const modals = document.querySelectorAll('[data-was-visible="true"]');
          modals.forEach(modal => {
            modal.style.display = '';
            modal.removeAttribute('data-was-visible');
          });
        };

        // Enhanced SweetAlert configuration
        const getFullSweetAlertConfig = (icon, iconColor = null) => {
          return {
            icon,
            iconColor: iconColor || (icon === 'error' ? '#dc2626' : icon === 'success' ? '#10b981' : icon === 'warning' ? '#f59e0b' : '#3b82f6'),
            confirmButtonText: 'OK',
            confirmButtonColor: '#4F46E5',
            allowOutsideClick: false,
            allowEscapeKey: true,
            backdrop: 'rgba(0, 0, 0, 0.6)',
            position: 'center',
            customClass: {
              container: 'swal-container-custom swal-high-z-index',
              popup: 'swal-popup-custom',
              title: 'swal-title-custom',
              htmlContainer: 'swal-content-custom',
              actions: 'swal-actions-custom',
              confirmButton: 'swal-ok-btn',
              icon: 'swal-icon-custom'
            },
            buttonsStyling: false,
            didRender: () => {
              const root = document.getElementById('root');
              if (root && root.hasAttribute('aria-hidden')) {
                root.removeAttribute('aria-hidden');
              }
            },
            didOpen: () => {
              hideAllOtherModals();
              
              const popup = Swal.getPopup();
              if (popup) {
                popup.style.fontFamily = 'Inter, sans-serif';
                popup.style.background = '#FEFEFA';
                popup.style.borderRadius = '1.5rem';
                popup.style.boxShadow = '0 8px 32px rgba(0,0,0,0.18)';
                popup.style.border = '2px solid #A0C49D';
                popup.style.padding = '2rem';
                popup.style.minWidth = '320px';
                popup.style.maxWidth = '400px';
                popup.style.width = '100%';
              }
              
              const container = document.querySelector('.swal2-container');
              if (container) {
                container.style.zIndex = '2147483647';
              }
              
              const root = document.getElementById('root');
              if (root && root.hasAttribute('aria-hidden')) {
                root.removeAttribute('aria-hidden');
              }
            },
            didClose: () => {
              restoreHiddenModals();
              
              const root = document.getElementById('root');
              if (root && root.hasAttribute('aria-hidden')) {
                root.removeAttribute('aria-hidden');
              }
            }
          };
        };

        // Test functions
        function testError() {
            const config = getFullSweetAlertConfig('error', '#dc2626');
            Swal.fire({
                title: 'Error Alert',
                text: 'This is an enhanced error alert with full styling and modal management.',
                ...config
            });
            logResult('Error alert displayed with enhanced styling ✅');
        }

        function testSuccess() {
            const config = getFullSweetAlertConfig('success', '#10b981');
            Swal.fire({
                title: 'Success Alert',
                text: 'This is an enhanced success alert with consistent styling.',
                ...config
            });
            logResult('Success alert displayed with enhanced styling ✅');
        }

        function testWarning() {
            const config = getFullSweetAlertConfig('warning', '#f59e0b');
            Swal.fire({
                title: 'Warning Alert',
                text: 'This is an enhanced warning alert (like marriage age validation).',
                ...config
            });
            logResult('Warning alert displayed with enhanced styling ✅');
        }

        function testInfo() {
            const config = getFullSweetAlertConfig('info', '#3b82f6');
            Swal.fire({
                title: 'Info Alert',
                text: 'This is an enhanced info alert with full styling.',
                ...config
            });
            logResult('Info alert displayed with enhanced styling ✅');
        }

        function testConfirm() {
            const config = getFullSweetAlertConfig('question', '#3b82f6');
            Swal.fire({
                title: 'Confirm Action',
                text: 'Do you want to proceed with this action?',
                showCancelButton: true,
                confirmButtonText: 'Yes',
                cancelButtonText: 'No',
                cancelButtonColor: '#6B7280',
                ...config
            }).then((result) => {
                if (result.isConfirmed) {
                    logResult('Confirm dialog - User clicked Yes ✅');
                } else {
                    logResult('Confirm dialog - User clicked No or cancelled ✅');
                }
            });
            logResult('Confirm dialog displayed with enhanced styling ✅');
        }

        function testDeleteConfirm() {
            const config = getFullSweetAlertConfig('warning', '#f59e0b');
            Swal.fire({
                title: 'Delete Confirmation',
                text: 'Are you sure you want to delete this item? This action cannot be undone.',
                showCancelButton: true,
                confirmButtonText: 'Delete',
                cancelButtonText: 'Cancel',
                confirmButtonColor: '#dc2626',
                cancelButtonColor: '#6b7280',
                reverseButtons: true,
                customClass: {
                  ...config.customClass,
                  confirmButton: 'swal-confirm-btn',
                  cancelButton: 'swal-cancel-btn',
                },
                ...config
            }).then((result) => {
                if (result.isConfirmed) {
                    logResult('Delete confirm - User clicked Delete ✅');
                } else {
                    logResult('Delete confirm - User cancelled ✅');
                }
            });
            logResult('Delete confirm dialog displayed with enhanced styling ✅');
        }

        function testToast() {
            Swal.fire({
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 3000,
                timerProgressBar: true,
                icon: 'success',
                title: 'Enhanced Toast Notification',
                customClass: {
                  container: 'swal-high-z-index',
                  popup: 'swal-popup-custom'
                },
                didOpen: () => {
                  const container = document.querySelector('.swal2-container');
                  if (container) {
                    container.style.zIndex = '2147483647';
                  }
                }
            });
            logResult('Toast notification displayed with enhanced styling ✅');
        }

        function testModalManagement() {
            // Show existing modal first
            showExistingModal();
            
            setTimeout(() => {
                // Then show SweetAlert - existing modal should be hidden
                const config = getFullSweetAlertConfig('info', '#3b82f6');
                Swal.fire({
                    title: 'Modal Management Test',
                    text: 'The existing modal should now be hidden. When you close this alert, it should reappear.',
                    ...config
                });
                logResult('Modal management test - Existing modal hidden when SweetAlert appeared ✅');
            }, 1000);
        }

        function testOperationSuccess() {
            // Test different operation success types with professional titles
            const operations = [
                { type: 'personAdded', title: 'Person Added Successfully', message: 'John Doe has been successfully added to the family tree!' },
                { type: 'linkCopied', title: 'Link Copied Successfully', message: 'Profile link copied to clipboard!' },
                { type: 'notesUpdated', title: 'Notes Updated Successfully', message: 'Notes and stories have been successfully updated!' },
                { type: 'factDeleted', title: 'Fact Deleted Successfully', message: 'Fact deleted successfully!' },
                { type: 'mediaDeleted', title: 'Media Deleted Successfully', message: 'Media deleted successfully!' }
            ];

            let index = 0;
            function showNext() {
                if (index < operations.length) {
                    const op = operations[index];
                    const config = getFullSweetAlertConfig('success', '#10b981');
                    Swal.fire({
                        title: op.title,
                        text: op.message,
                        ...config
                    }).then(() => {
                        index++;
                        if (index < operations.length) {
                            setTimeout(showNext, 500);
                        }
                    });
                    logResult(`Operation success test - ${op.type} with professional title ✅`);
                }
            }
            showNext();
        }

        function showExistingModal() {
            document.getElementById('modalOverlay').style.display = 'block';
            document.getElementById('existingModal').style.display = 'block';
            logResult('Existing modal displayed ✅');
        }

        function hideExistingModal() {
            document.getElementById('modalOverlay').style.display = 'none';
            document.getElementById('existingModal').style.display = 'none';
            logResult('Existing modal hidden ✅');
        }

        function logResult(message) {
            const results = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString();
            results.innerHTML += `<div>[${timestamp}] ${message}</div>`;
        }

        // Initialize
        logResult('Enhanced SweetAlert test page loaded ✅');
    </script>
</body>
</html>
