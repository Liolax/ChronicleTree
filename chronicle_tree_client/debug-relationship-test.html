<!DOCTYPE html>
<html>
<head>
    <title>Relationship Calculator Debug</title>
</head>
<body>
    <h1>Debug Relationship Calculator</h1>
    <div id="output"></div>
    
    <script type="module">
        import { calculateRelationshipToRoot } from './src/utils/improvedRelationshipCalculator.js';
        
        // Test data matching the seeds
        const testPeople = [
          { id: 1, first_name: 'John', last_name: 'Doe', gender: 'Male' },
          { id: 2, first_name: 'Jane', last_name: 'Doe', gender: 'Female' },
          { id: 3, first_name: 'Alice', last_name: 'A', gender: 'Female' },
          { id: 4, first_name: 'David', last_name: 'A', gender: 'Male' },
          { id: 5, first_name: 'Charlie', last_name: 'C', gender: 'Male' },
          { id: 6, first_name: 'Bob', last_name: 'B', gender: 'Male' },
          { id: 7, first_name: 'Emily', last_name: 'E', gender: 'Female' }
        ];

        // API edge format (what the React app receives)
        const apiEdgeFormat = [
          // Parent-child relationships
          { from: 1, to: 3, type: 'parent' },
          { from: 3, to: 1, type: 'child' },
          { from: 2, to: 3, type: 'parent' },
          { from: 3, to: 2, type: 'child' },
          { from: 1, to: 5, type: 'parent' },
          { from: 5, to: 1, type: 'child' },
          { from: 2, to: 5, type: 'parent' },
          { from: 5, to: 2, type: 'child' },
          { from: 3, to: 6, type: 'parent' },
          { from: 6, to: 3, type: 'child' },
          { from: 4, to: 6, type: 'parent' },
          { from: 6, to: 4, type: 'child' },
          { from: 3, to: 7, type: 'parent' },
          { from: 7, to: 3, type: 'child' },
          { from: 4, to: 7, type: 'parent' },
          { from: 7, to: 4, type: 'child' },
          
          // Spouse relationships (ex-spouses)
          { from: 1, to: 2, type: 'spouse', is_ex: false },
          { from: 2, to: 1, type: 'spouse', is_ex: false },
          { from: 3, to: 4, type: 'spouse', is_ex: true },
          { from: 4, to: 3, type: 'spouse', is_ex: true },
          
          // Sibling relationships
          { from: 6, to: 7, type: 'sibling' },
          { from: 7, to: 6, type: 'sibling' },
          { from: 5, to: 3, type: 'sibling' },
          { from: 3, to: 5, type: 'sibling' }
        ];
        
        const outputDiv = document.getElementById('output');
        
        // Test the relationship calculation with debug output
        outputDiv.innerHTML += '<h2>Testing Charlie → David relationship:</h2>';
        
        try {
            const charlieToData = testPeople.find(p => p.id === 5);
            const davidToData = testPeople.find(p => p.id === 4);
            
            console.log('=== RELATIONSHIP CALCULATOR DEBUG TEST ===');
            const result = calculateRelationshipToRoot(davidToData, charlieToData, testPeople, apiEdgeFormat);
            
            outputDiv.innerHTML += `<p><strong>David → Charlie: "${result}"</strong></p>`;
            console.log(`David → Charlie: "${result}"`);
            
            // Also test the reverse
            const reverseResult = calculateRelationshipToRoot(charlieToData, davidToData, testPeople, apiEdgeFormat);
            outputDiv.innerHTML += `<p><strong>Charlie → David: "${reverseResult}"</strong></p>`;
            console.log(`Charlie → David: "${reverseResult}"`);
            
            outputDiv.innerHTML += '<p>Check the browser console for detailed debug output.</p>';
            
        } catch (error) {
            outputDiv.innerHTML += `<p style="color: red;">Error: ${error.message}</p>`;
            console.error('Error:', error);
        }
    </script>
</body>
</html>
